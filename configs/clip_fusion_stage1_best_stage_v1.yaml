exp_name: "clip_fusion_stage1_v1"
seed: 42
device: "cuda"
fast_sanity: false

data:
  root: "data"
  train_csv: "train.csv"
  test_csv: "test.csv"
  train_img_dir: "train_images"
  test_img_dir: "test_images"
  id_col: "id"
  label_col: "categories"
  text_cols: ["title", "description"]
  max_len: 77
  num_classes: 21
  multi_image_mode: "first"
  img_size: 224
  num_workers: 8

model:
  type: "clip_fusion"
  clip_backbone: "ViT-L-14"
  clip_pretrained: "openai"
  clip_trainable: false
  clip_force_quick_gelu: true
  dropout: 0.2
  hidden_dim: 512

train:
  folds: 5
  fold: -1
  epochs: 5
  batch_size: 64
  lr: 1e-3
  lrs:
    head: 1e-3
  weight_decay: 0.01
  amp: true
  grad_accum: 1
  label_smoothing: 0.0
  class_weight: false
  early_stop_patience: 2
  log_every: 50

infer:
  batch_size: 96
  tta: true
  ckpt_dir: "checkpoints/clip_fusion_stage1_v1"
  output: "submission_clip_stage1.csv"
