exp_name: "fusion_v4"
seed: 42
device: "cuda"
fast_sanity: false

data:
  root: "data"
  train_csv: "train.csv"
  test_csv: "test.csv"
  train_img_dir: "train_images"
  test_img_dir: "test_images"
  id_col: "id"
  label_col: "categories"
  text_cols: ["title", "description"]
  max_len: 64
  num_classes: 21
  multi_image_mode: "first"   # first|random|mean_pool
  img_size: 160
  num_workers: 8

model:
  type: "fusion"
  image_backbone: "convnext_base"
  image_pretrained: true
  text_backbone: "microsoft/deberta-v3-base"
  fusion: "gated_concat"
  dropout: 0.35
  hidden_dim: 768   # 可以升一点，配合更强 backbone（可选）

train:
  folds: 5
  fold: -1                    # -1=all folds, else 0..folds-1
  epochs: 20                  # 交给 early stop 决定停在哪
  batch_size: 96
  lr: 2e-5                    # base lr（若实现里仅在 lrs 缺省时使用，这里无影响）
  lrs:                        # per-module lr（你已支持）
    image_encoder: 3e-5
    text_encoder: 1.5e-5
    head: 5e-4
  weight_decay: 0.01
  amp: true
  grad_accum: 1
  label_smoothing: 0.05
  class_weight: false
  early_stop_patience: 2
  log_every: 50

infer:
  batch_size: 96
  tta: true
  ckpt_dir: "checkpoints/fusion_v4"
  output: "submission.csv"
